package me.bytebeats.ipp.worldclock

import com.intellij.openapi.diagnostic.Logger
import java.time.LocalDateTime
import java.time.ZoneId
import java.time.format.DateTimeFormatter
import java.util.function.Consumer


private val LOG: Logger = Logger.getInstance("WorldClock")

// https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/format/DateTimeFormatter.html
// Examples:
// E hh:mm a  -> Tue 08:29 PM
// EEEE HH:mm -> Tuesday 20:39
private val DATETIME_FORMATTER_12H = DateTimeFormatter.ofPattern("E hh:mm a")
private val DATETIME_FORMATTER_24H = DateTimeFormatter.ofPattern("E HH:mm")

fun getCurrentDate(timeZoneId: ZoneId, use24HDateFormat: Boolean): String {
    val dtf = if (use24HDateFormat) DATETIME_FORMATTER_24H else DATETIME_FORMATTER_12H
    return dtf.format(LocalDateTime.now(timeZoneId))
}

fun findFlagByTimeZoneId(timeZoneId: String): String? {
    return getAllAvailableTZAndFlags()[timeZoneId]
}

private val timeZoneIdsAndFlags = mutableMapOf<String, String?>()

fun getAllAvailableTZAndFlags(): Map<String, String?> {
    if (timeZoneIdsAndFlags.isNotEmpty()) {
        return timeZoneIdsAndFlags
    }

    // generated by ICU4J
    timeZoneIdsAndFlags["Africa/Abidjan"] = "ci"
    timeZoneIdsAndFlags["Africa/Accra"] = "gh"
    timeZoneIdsAndFlags["Africa/Addis_Ababa"] = "et"
    timeZoneIdsAndFlags["Africa/Algiers"] = "dz"
    timeZoneIdsAndFlags["Africa/Asmera"] = "er"
    timeZoneIdsAndFlags["Africa/Bamako"] = "ml"
    timeZoneIdsAndFlags["Africa/Bangui"] = "cf"
    timeZoneIdsAndFlags["Africa/Banjul"] = "gm"
    timeZoneIdsAndFlags["Africa/Bissau"] = "gw"
    timeZoneIdsAndFlags["Africa/Blantyre"] = "mw"
    timeZoneIdsAndFlags["Africa/Brazzaville"] = "cg"
    timeZoneIdsAndFlags["Africa/Bujumbura"] = "bi"
    timeZoneIdsAndFlags["Africa/Cairo"] = "eg"
    timeZoneIdsAndFlags["Africa/Casablanca"] = "ma"
    timeZoneIdsAndFlags["Africa/Ceuta"] = "es"
    timeZoneIdsAndFlags["Africa/Conakry"] = "gn"
    timeZoneIdsAndFlags["Africa/Dakar"] = "sn"
    timeZoneIdsAndFlags["Africa/Dar_es_Salaam"] = "tz"
    timeZoneIdsAndFlags["Africa/Djibouti"] = "dj"
    timeZoneIdsAndFlags["Africa/Douala"] = "cm"
    timeZoneIdsAndFlags["Africa/El_Aaiun"] = "eh"
    timeZoneIdsAndFlags["Africa/Freetown"] = "sl"
    timeZoneIdsAndFlags["Africa/Gaborone"] = "bw"
    timeZoneIdsAndFlags["Africa/Harare"] = "zw"
    timeZoneIdsAndFlags["Africa/Johannesburg"] = "za"
    timeZoneIdsAndFlags["Africa/Kampala"] = "ug"
    timeZoneIdsAndFlags["Africa/Khartoum"] = "sd"
    timeZoneIdsAndFlags["Africa/Kigali"] = "rw"
    timeZoneIdsAndFlags["Africa/Kinshasa"] = "cd"
    timeZoneIdsAndFlags["Africa/Lagos"] = "ng"
    timeZoneIdsAndFlags["Africa/Libreville"] = "ga"
    timeZoneIdsAndFlags["Africa/Lome"] = "tg"
    timeZoneIdsAndFlags["Africa/Luanda"] = "ao"
    timeZoneIdsAndFlags["Africa/Lubumbashi"] = "cd"
    timeZoneIdsAndFlags["Africa/Lusaka"] = "zm"
    timeZoneIdsAndFlags["Africa/Malabo"] = "gq"
    timeZoneIdsAndFlags["Africa/Maputo"] = "mz"
    timeZoneIdsAndFlags["Africa/Maseru"] = "ls"
    timeZoneIdsAndFlags["Africa/Mbabane"] = "sz"
    timeZoneIdsAndFlags["Africa/Mogadishu"] = "so"
    timeZoneIdsAndFlags["Africa/Monrovia"] = "lr"
    timeZoneIdsAndFlags["Africa/Nairobi"] = "ke"
    timeZoneIdsAndFlags["Africa/Ndjamena"] = "td"
    timeZoneIdsAndFlags["Africa/Niamey"] = "ne"
    timeZoneIdsAndFlags["Africa/Nouakchott"] = "mr"
    timeZoneIdsAndFlags["Africa/Ouagadougou"] = "bf"
    timeZoneIdsAndFlags["Africa/Porto-Novo"] = "bj"
    timeZoneIdsAndFlags["Africa/Sao_Tome"] = "st"
    timeZoneIdsAndFlags["Africa/Timbuktu"] = "ml"
    timeZoneIdsAndFlags["Africa/Tripoli"] = "ly"
    timeZoneIdsAndFlags["Africa/Tunis"] = "tn"
    timeZoneIdsAndFlags["Africa/Windhoek"] = "na"
    timeZoneIdsAndFlags["America/Adak"] = "us"
    timeZoneIdsAndFlags["America/Anchorage"] = "us"
    timeZoneIdsAndFlags["America/Anguilla"] = "ai"
    timeZoneIdsAndFlags["America/Antigua"] = "ag"
    timeZoneIdsAndFlags["America/Araguaina"] = "br"
    timeZoneIdsAndFlags["America/Aruba"] = "aw"
    timeZoneIdsAndFlags["America/Asuncion"] = "py"
    timeZoneIdsAndFlags["America/Barbados"] = "bb"
    timeZoneIdsAndFlags["America/Belem"] = "br"
    timeZoneIdsAndFlags["America/Belize"] = "bz"
    timeZoneIdsAndFlags["America/Boa_Vista"] = "br"
    timeZoneIdsAndFlags["America/Bogota"] = "co"
    timeZoneIdsAndFlags["America/Boise"] = "us"
    timeZoneIdsAndFlags["America/Buenos_Aires"] = "ar"
    timeZoneIdsAndFlags["America/Cambridge_Bay"] = "ca"
    timeZoneIdsAndFlags["America/Cancun"] = "mx"
    timeZoneIdsAndFlags["America/Caracas"] = "ve"
    timeZoneIdsAndFlags["America/Catamarca"] = "ar"
    timeZoneIdsAndFlags["America/Cayenne"] = "gf"
    timeZoneIdsAndFlags["America/Cayman"] = "ky"
    timeZoneIdsAndFlags["America/Chicago"] = "us"
    timeZoneIdsAndFlags["America/Chihuahua"] = "mx"
    timeZoneIdsAndFlags["America/Cordoba"] = "ar"
    timeZoneIdsAndFlags["America/Costa_Rica"] = "cr"
    timeZoneIdsAndFlags["America/Cuiaba"] = "br"
    timeZoneIdsAndFlags["America/Danmarkshavn"] = "gl"
    timeZoneIdsAndFlags["America/Dawson"] = "ca"
    timeZoneIdsAndFlags["America/Dawson_Creek"] = "ca"
    timeZoneIdsAndFlags["America/Denver"] = "us"
    timeZoneIdsAndFlags["America/Detroit"] = "us"
    timeZoneIdsAndFlags["America/Dominica"] = "dm"
    timeZoneIdsAndFlags["America/Edmonton"] = "ca"
    timeZoneIdsAndFlags["America/Eirunepe"] = "br"
    timeZoneIdsAndFlags["America/El_Salvador"] = "sv"
    timeZoneIdsAndFlags["America/Fortaleza"] = "br"
    timeZoneIdsAndFlags["America/Glace_Bay"] = "ca"
    timeZoneIdsAndFlags["America/Godthab"] = "gl"
    timeZoneIdsAndFlags["America/Goose_Bay"] = "ca"
    timeZoneIdsAndFlags["America/Grand_Turk"] = "tc"
    timeZoneIdsAndFlags["America/Grenada"] = "gd"
    timeZoneIdsAndFlags["America/Guadeloupe"] = "gp"
    timeZoneIdsAndFlags["America/Guatemala"] = "gt"
    timeZoneIdsAndFlags["America/Guayaquil"] = "ec"
    timeZoneIdsAndFlags["America/Guyana"] = "gy"
    timeZoneIdsAndFlags["America/Halifax"] = "ca"
    timeZoneIdsAndFlags["America/Havana"] = "cu"
    timeZoneIdsAndFlags["America/Hermosillo"] = "mx"
    timeZoneIdsAndFlags["America/Indiana/Knox"] = "us"
    timeZoneIdsAndFlags["America/Indiana/Marengo"] = "us"
    timeZoneIdsAndFlags["America/Indiana/Vevay"] = "us"
    timeZoneIdsAndFlags["America/Indianapolis"] = "us"
    timeZoneIdsAndFlags["America/Inuvik"] = "ca"
    timeZoneIdsAndFlags["America/Iqaluit"] = "ca"
    timeZoneIdsAndFlags["America/Jamaica"] = "jm"
    timeZoneIdsAndFlags["America/Jujuy"] = "ar"
    timeZoneIdsAndFlags["America/Juneau"] = "us"
    timeZoneIdsAndFlags["America/Kentucky/Monticello"] = "us"
    timeZoneIdsAndFlags["America/La_Paz"] = "bo"
    timeZoneIdsAndFlags["America/Lima"] = "pe"
    timeZoneIdsAndFlags["America/Los_Angeles"] = "us"
    timeZoneIdsAndFlags["America/Louisville"] = "us"
    timeZoneIdsAndFlags["America/Maceio"] = "br"
    timeZoneIdsAndFlags["America/Managua"] = "ni"
    timeZoneIdsAndFlags["America/Manaus"] = "br"
    timeZoneIdsAndFlags["America/Martinique"] = "mq"
    timeZoneIdsAndFlags["America/Mazatlan"] = "mx"
    timeZoneIdsAndFlags["America/Mendoza"] = "ar"
    timeZoneIdsAndFlags["America/Menominee"] = "us"
    timeZoneIdsAndFlags["America/Merida"] = "mx"
    timeZoneIdsAndFlags["America/Mexico_City"] = "mx"
    timeZoneIdsAndFlags["America/Miquelon"] = "pm"
    timeZoneIdsAndFlags["America/Monterrey"] = "mx"
    timeZoneIdsAndFlags["America/Montevideo"] = "uy"
    timeZoneIdsAndFlags["America/Montreal"] = "ca"
    timeZoneIdsAndFlags["America/Montserrat"] = "ms"
    timeZoneIdsAndFlags["America/Nassau"] = "bs"
    timeZoneIdsAndFlags["America/New_York"] = "us"
    timeZoneIdsAndFlags["America/Nipigon"] = "ca"
    timeZoneIdsAndFlags["America/Nome"] = "us"
    timeZoneIdsAndFlags["America/Noronha"] = "br"
    timeZoneIdsAndFlags["America/North_Dakota/Center"] = "us"
    timeZoneIdsAndFlags["America/Panama"] = "pa"
    timeZoneIdsAndFlags["America/Pangnirtung"] = "ca"
    timeZoneIdsAndFlags["America/Paramaribo"] = "sr"
    timeZoneIdsAndFlags["America/Phoenix"] = "us"
    timeZoneIdsAndFlags["America/Port-au-Prince"] = "ht"
    timeZoneIdsAndFlags["America/Port_of_Spain"] = "tt"
    timeZoneIdsAndFlags["America/Porto_Velho"] = "br"
    timeZoneIdsAndFlags["America/Puerto_Rico"] = "pr"
    timeZoneIdsAndFlags["America/Rainy_River"] = "ca"
    timeZoneIdsAndFlags["America/Rankin_Inlet"] = "ca"
    timeZoneIdsAndFlags["America/Recife"] = "br"
    timeZoneIdsAndFlags["America/Regina"] = "ca"
    timeZoneIdsAndFlags["America/Rio_Branco"] = "br"
    timeZoneIdsAndFlags["America/Santiago"] = "cl"
    timeZoneIdsAndFlags["America/Santo_Domingo"] = "do"
    timeZoneIdsAndFlags["America/Sao_Paulo"] = "br"
    timeZoneIdsAndFlags["America/Scoresbysund"] = "gl"
    timeZoneIdsAndFlags["America/St_Johns"] = "ca"
    timeZoneIdsAndFlags["America/St_Kitts"] = "kn"
    timeZoneIdsAndFlags["America/St_Lucia"] = "lc"
    timeZoneIdsAndFlags["America/St_Thomas"] = "vi"
    timeZoneIdsAndFlags["America/St_Vincent"] = "vc"
    timeZoneIdsAndFlags["America/Swift_Current"] = "ca"
    timeZoneIdsAndFlags["America/Tegucigalpa"] = "hn"
    timeZoneIdsAndFlags["America/Thule"] = "gl"
    timeZoneIdsAndFlags["America/Thunder_Bay"] = "ca"
    timeZoneIdsAndFlags["America/Tijuana"] = "mx"
    timeZoneIdsAndFlags["America/Tortola"] = "vg"
    timeZoneIdsAndFlags["America/Vancouver"] = "ca"
    timeZoneIdsAndFlags["America/Whitehorse"] = "ca"
    timeZoneIdsAndFlags["America/Winnipeg"] = "ca"
    timeZoneIdsAndFlags["America/Yakutat"] = "us"
    timeZoneIdsAndFlags["America/Yellowknife"] = "ca"
    timeZoneIdsAndFlags["Antarctica/Casey"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Davis"] = "aq"
    timeZoneIdsAndFlags["Antarctica/DumontDUrville"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Mawson"] = "aq"
    timeZoneIdsAndFlags["Antarctica/McMurdo"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Palmer"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Rothera"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Syowa"] = "aq"
    timeZoneIdsAndFlags["Antarctica/Vostok"] = "aq"
    timeZoneIdsAndFlags["Arctic/Longyearbyen"] = "sj"
    timeZoneIdsAndFlags["Asia/Aden"] = "ye"
    timeZoneIdsAndFlags["Asia/Almaty"] = "kz"
    timeZoneIdsAndFlags["Asia/Amman"] = "jo"
    timeZoneIdsAndFlags["Asia/Anadyr"] = "ru"
    timeZoneIdsAndFlags["Asia/Aqtau"] = "kz"
    timeZoneIdsAndFlags["Asia/Aqtobe"] = "kz"
    timeZoneIdsAndFlags["Asia/Ashgabat"] = "tm"
    timeZoneIdsAndFlags["Asia/Baghdad"] = "iq"
    timeZoneIdsAndFlags["Asia/Bahrain"] = "bh"
    timeZoneIdsAndFlags["Asia/Baku"] = "az"
    timeZoneIdsAndFlags["Asia/Bangkok"] = "th"
    timeZoneIdsAndFlags["Asia/Beirut"] = "lb"
    timeZoneIdsAndFlags["Asia/Bishkek"] = "kg"
    timeZoneIdsAndFlags["Asia/Brunei"] = "bn"
    timeZoneIdsAndFlags["Asia/Calcutta"] = "in"
    timeZoneIdsAndFlags["Asia/Choibalsan"] = "mn"
    timeZoneIdsAndFlags["Asia/Chongqing"] = "cn"
    timeZoneIdsAndFlags["Asia/Colombo"] = "lk"
    timeZoneIdsAndFlags["Asia/Damascus"] = "sy"
    timeZoneIdsAndFlags["Asia/Dhaka"] = "bd"
    timeZoneIdsAndFlags["Asia/Dili"] = "tl"
    timeZoneIdsAndFlags["Asia/Dubai"] = "ae"
    timeZoneIdsAndFlags["Asia/Dushanbe"] = "tj"
    timeZoneIdsAndFlags["Asia/Gaza"] = "ps"
    timeZoneIdsAndFlags["Asia/Harbin"] = "cn"
    timeZoneIdsAndFlags["Asia/Hong_Kong"] = "hk"
    timeZoneIdsAndFlags["Asia/Hovd"] = "mn"
    timeZoneIdsAndFlags["Asia/Irkutsk"] = "ru"
    timeZoneIdsAndFlags["Asia/Jakarta"] = "id"
    timeZoneIdsAndFlags["Asia/Jayapura"] = "id"
    timeZoneIdsAndFlags["Asia/Jerusalem"] = "il"
    timeZoneIdsAndFlags["Asia/Kabul"] = "af"
    timeZoneIdsAndFlags["Asia/Kamchatka"] = "ru"
    timeZoneIdsAndFlags["Asia/Karachi"] = "pk"
    timeZoneIdsAndFlags["Asia/Kashgar"] = "cn"
    timeZoneIdsAndFlags["Asia/Katmandu"] = "np"
    timeZoneIdsAndFlags["Asia/Krasnoyarsk"] = "ru"
    timeZoneIdsAndFlags["Asia/Kuala_Lumpur"] = "my"
    timeZoneIdsAndFlags["Asia/Kuching"] = "my"
    timeZoneIdsAndFlags["Asia/Kuwait"] = "kw"
    timeZoneIdsAndFlags["Asia/Macau"] = "mo"
    timeZoneIdsAndFlags["Asia/Magadan"] = "ru"
    timeZoneIdsAndFlags["Asia/Makassar"] = "id"
    timeZoneIdsAndFlags["Asia/Manila"] = "ph"
    timeZoneIdsAndFlags["Asia/Muscat"] = "om"
    timeZoneIdsAndFlags["Asia/Nicosia"] = "cy"
    timeZoneIdsAndFlags["Asia/Novosibirsk"] = "ru"
    timeZoneIdsAndFlags["Asia/Omsk"] = "ru"
    timeZoneIdsAndFlags["Asia/Oral"] = "kz"
    timeZoneIdsAndFlags["Asia/Phnom_Penh"] = "kh"
    timeZoneIdsAndFlags["Asia/Pontianak"] = "id"
    timeZoneIdsAndFlags["Asia/Pyongyang"] = "kp"
    timeZoneIdsAndFlags["Asia/Qatar"] = "qa"
    timeZoneIdsAndFlags["Asia/Qyzylorda"] = "kz"
    timeZoneIdsAndFlags["Asia/Rangoon"] = "mm"
    timeZoneIdsAndFlags["Asia/Riyadh"] = "sa"
    timeZoneIdsAndFlags["Asia/Saigon"] = "vn"
    timeZoneIdsAndFlags["Asia/Sakhalin"] = "ru"
    timeZoneIdsAndFlags["Asia/Samarkand"] = "uz"
    timeZoneIdsAndFlags["Asia/Seoul"] = "kr"
    timeZoneIdsAndFlags["Asia/Shanghai"] = "cn"
    timeZoneIdsAndFlags["Asia/Singapore"] = "sg"
    timeZoneIdsAndFlags["Asia/Taipei"] = "tw"
    timeZoneIdsAndFlags["Asia/Tashkent"] = "uz"
    timeZoneIdsAndFlags["Asia/Tbilisi"] = "ge"
    timeZoneIdsAndFlags["Asia/Tehran"] = "ir"
    timeZoneIdsAndFlags["Asia/Thimphu"] = "bt"
    timeZoneIdsAndFlags["Asia/Tokyo"] = "jp"
    timeZoneIdsAndFlags["Asia/Ulaanbaatar"] = "mn"
    timeZoneIdsAndFlags["Asia/Urumqi"] = "cn"
    timeZoneIdsAndFlags["Asia/Vientiane"] = "la"
    timeZoneIdsAndFlags["Asia/Vladivostok"] = "ru"
    timeZoneIdsAndFlags["Asia/Yakutsk"] = "ru"
    timeZoneIdsAndFlags["Asia/Yekaterinburg"] = "ru"
    timeZoneIdsAndFlags["Asia/Yerevan"] = "am"
    timeZoneIdsAndFlags["Atlantic/Azores"] = "pt"
    timeZoneIdsAndFlags["Atlantic/Bermuda"] = "bm"
    timeZoneIdsAndFlags["Atlantic/Canary"] = "es"
    timeZoneIdsAndFlags["Atlantic/Cape_Verde"] = "cv"
    timeZoneIdsAndFlags["Atlantic/Faeroe"] = "fo"
    timeZoneIdsAndFlags["Atlantic/Jan_Mayen"] = "sj"
    timeZoneIdsAndFlags["Atlantic/Madeira"] = "pt"
    timeZoneIdsAndFlags["Atlantic/Reykjavik"] = "is"
    timeZoneIdsAndFlags["Atlantic/South_Georgia"] = "gs"
    timeZoneIdsAndFlags["Atlantic/St_Helena"] = "sh"
    timeZoneIdsAndFlags["Atlantic/Stanley"] = "fk"
    timeZoneIdsAndFlags["Australia/Adelaide"] = "au"
    timeZoneIdsAndFlags["Australia/Brisbane"] = "au"
    timeZoneIdsAndFlags["Australia/Broken_Hill"] = "au"
    timeZoneIdsAndFlags["Australia/Darwin"] = "au"
    timeZoneIdsAndFlags["Australia/Hobart"] = "au"
    timeZoneIdsAndFlags["Australia/Lindeman"] = "au"
    timeZoneIdsAndFlags["Australia/Lord_Howe"] = "au"
    timeZoneIdsAndFlags["Australia/Melbourne"] = "au"
    timeZoneIdsAndFlags["Australia/Perth"] = "au"
    timeZoneIdsAndFlags["Australia/Sydney"] = "au"
    timeZoneIdsAndFlags["Europe/Amsterdam"] = "nl"
    timeZoneIdsAndFlags["Europe/Andorra"] = "ad"
    timeZoneIdsAndFlags["Europe/Athens"] = "gr"
    timeZoneIdsAndFlags["Europe/Belfast"] = "gb"
    timeZoneIdsAndFlags["Europe/Berlin"] = "de"
    timeZoneIdsAndFlags["Europe/Bratislava"] = "sk"
    timeZoneIdsAndFlags["Europe/Brussels"] = "be"
    timeZoneIdsAndFlags["Europe/Bucharest"] = "ro"
    timeZoneIdsAndFlags["Europe/Budapest"] = "hu"
    timeZoneIdsAndFlags["Europe/Chisinau"] = "md"
    timeZoneIdsAndFlags["Europe/Copenhagen"] = "dk"
    timeZoneIdsAndFlags["Europe/Dublin"] = "ie"
    timeZoneIdsAndFlags["Europe/Gibraltar"] = "gi"
    timeZoneIdsAndFlags["Europe/Helsinki"] = "fi"
    timeZoneIdsAndFlags["Europe/Istanbul"] = "tr"
    timeZoneIdsAndFlags["Europe/Kaliningrad"] = "ru"
    timeZoneIdsAndFlags["Europe/Kiev"] = "ua"
    timeZoneIdsAndFlags["Europe/Lisbon"] = "pt"
    timeZoneIdsAndFlags["Europe/Ljubljana"] = "si"
    timeZoneIdsAndFlags["Europe/London"] = "gb"
    timeZoneIdsAndFlags["Europe/Luxembourg"] = "lu"
    timeZoneIdsAndFlags["Europe/Madrid"] = "es"
    timeZoneIdsAndFlags["Europe/Malta"] = "mt"
    timeZoneIdsAndFlags["Europe/Minsk"] = "by"
    timeZoneIdsAndFlags["Europe/Monaco"] = "mc"
    timeZoneIdsAndFlags["Europe/Moscow"] = "ru"
    timeZoneIdsAndFlags["Europe/Oslo"] = "no"
    timeZoneIdsAndFlags["Europe/Paris"] = "fr"
    timeZoneIdsAndFlags["Europe/Prague"] = "cz"
    timeZoneIdsAndFlags["Europe/Riga"] = "lv"
    timeZoneIdsAndFlags["Europe/Rome"] = "it"
    timeZoneIdsAndFlags["Europe/Samara"] = "ru"
    timeZoneIdsAndFlags["Europe/San_Marino"] = "sm"
    timeZoneIdsAndFlags["Europe/Sarajevo"] = "ba"
    timeZoneIdsAndFlags["Europe/Simferopol"] = "ua"
    timeZoneIdsAndFlags["Europe/Skopje"] = "mk"
    timeZoneIdsAndFlags["Europe/Sofia"] = "bg"
    timeZoneIdsAndFlags["Europe/Stockholm"] = "se"
    timeZoneIdsAndFlags["Europe/Tallinn"] = "ee"
    timeZoneIdsAndFlags["Europe/Tirane"] = "al"
    timeZoneIdsAndFlags["Europe/Uzhgorod"] = "ua"
    timeZoneIdsAndFlags["Europe/Vaduz"] = "li"
    timeZoneIdsAndFlags["Europe/Vatican"] = "va"
    timeZoneIdsAndFlags["Europe/Vienna"] = "at"
    timeZoneIdsAndFlags["Europe/Vilnius"] = "lt"
    timeZoneIdsAndFlags["Europe/Warsaw"] = "pl"
    timeZoneIdsAndFlags["Europe/Zagreb"] = "hr"
    timeZoneIdsAndFlags["Europe/Zaporozhye"] = "ua"
    timeZoneIdsAndFlags["Europe/Zurich"] = "ch"
    timeZoneIdsAndFlags["Indian/Antananarivo"] = "mg"
    timeZoneIdsAndFlags["Indian/Chagos"] = "io"
    timeZoneIdsAndFlags["Indian/Christmas"] = "cx"
    timeZoneIdsAndFlags["Indian/Cocos"] = "cc"
    timeZoneIdsAndFlags["Indian/Comoro"] = "km"
    timeZoneIdsAndFlags["Indian/Kerguelen"] = "tf"
    timeZoneIdsAndFlags["Indian/Mahe"] = "sc"
    timeZoneIdsAndFlags["Indian/Maldives"] = "mv"
    timeZoneIdsAndFlags["Indian/Mauritius"] = "mu"
    timeZoneIdsAndFlags["Indian/Mayotte"] = "yt"
    timeZoneIdsAndFlags["Indian/Reunion"] = "re"
    timeZoneIdsAndFlags["Pacific/Apia"] = "ws"
    timeZoneIdsAndFlags["Pacific/Auckland"] = "nz"
    timeZoneIdsAndFlags["Pacific/Chatham"] = "nz"
    timeZoneIdsAndFlags["Pacific/Easter"] = "cl"
    timeZoneIdsAndFlags["Pacific/Efate"] = "vu"
    timeZoneIdsAndFlags["Pacific/Enderbury"] = "ki"
    timeZoneIdsAndFlags["Pacific/Fakaofo"] = "tk"
    timeZoneIdsAndFlags["Pacific/Fiji"] = "fj"
    timeZoneIdsAndFlags["Pacific/Funafuti"] = "tv"
    timeZoneIdsAndFlags["Pacific/Galapagos"] = "ec"
    timeZoneIdsAndFlags["Pacific/Gambier"] = "pf"
    timeZoneIdsAndFlags["Pacific/Guadalcanal"] = "sb"
    timeZoneIdsAndFlags["Pacific/Guam"] = "gu"
    timeZoneIdsAndFlags["Pacific/Honolulu"] = "us"
    timeZoneIdsAndFlags["Pacific/Johnston"] = "um"
    timeZoneIdsAndFlags["Pacific/Kiritimati"] = "ki"
    timeZoneIdsAndFlags["Pacific/Kosrae"] = "fm"
    timeZoneIdsAndFlags["Pacific/Kwajalein"] = "mh"
    timeZoneIdsAndFlags["Pacific/Majuro"] = "mh"
    timeZoneIdsAndFlags["Pacific/Marquesas"] = "pf"
    timeZoneIdsAndFlags["Pacific/Midway"] = "um"
    timeZoneIdsAndFlags["Pacific/Nauru"] = "nr"
    timeZoneIdsAndFlags["Pacific/Niue"] = "nu"
    timeZoneIdsAndFlags["Pacific/Norfolk"] = "nf"
    timeZoneIdsAndFlags["Pacific/Noumea"] = "nc"
    timeZoneIdsAndFlags["Pacific/Pago_Pago"] = "as"
    timeZoneIdsAndFlags["Pacific/Palau"] = "pw"
    timeZoneIdsAndFlags["Pacific/Pitcairn"] = "pn"
    timeZoneIdsAndFlags["Pacific/Ponape"] = "fm"
    timeZoneIdsAndFlags["Pacific/Port_Moresby"] = "pg"
    timeZoneIdsAndFlags["Pacific/Rarotonga"] = "ck"
    timeZoneIdsAndFlags["Pacific/Saipan"] = "mp"
    timeZoneIdsAndFlags["Pacific/Tahiti"] = "pf"
    timeZoneIdsAndFlags["Pacific/Tarawa"] = "ki"
    timeZoneIdsAndFlags["Pacific/Tongatapu"] = "to"
    timeZoneIdsAndFlags["Pacific/Truk"] = "fm"
    timeZoneIdsAndFlags["Pacific/Wake"] = "um"
    timeZoneIdsAndFlags["Pacific/Wallis"] = "wf"
    timeZoneIdsAndFlags["Pacific/Yap"] = "fm"

    // some zoneIds are not supported by running JVM: remove these unsupported zoneIds
    val unsupportedZoneIds = mutableSetOf<String>()
    val supportedJVMZoneIds = ZoneId.getAvailableZoneIds()
    for (zoneId in timeZoneIdsAndFlags.keys) {
        if (!supportedJVMZoneIds.contains(zoneId)) {
            unsupportedZoneIds.add(zoneId)
            LOG.warn("zoneId '$zoneId' is not supported by running JVM, ignoring")
        }
    }

    for (zoneId in unsupportedZoneIds) {
        timeZoneIdsAndFlags.remove(zoneId)
    }
    for (jvmZoneId in supportedJVMZoneIds) {
        if (!timeZoneIdsAndFlags.containsKey(jvmZoneId)) {
            // add zoneIds not supported by UCU4J. Generic associations
            if (jvmZoneId.startsWith("America/Argentina/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "ar"
            } else if (jvmZoneId.startsWith("America/Indiana/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "us"
            } else if (jvmZoneId.startsWith("America/North_Dakota/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "us"
            } else if (jvmZoneId.startsWith("Canada/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "ca"
            } else if (jvmZoneId.startsWith("Chile/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "cl"
            } else if (jvmZoneId.startsWith("Mexico/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "mx"
            } else if (jvmZoneId.startsWith("US/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "us"
            } else if (jvmZoneId.startsWith("Australia/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "au"
            } else if (jvmZoneId.startsWith("Brazil/")) {
                timeZoneIdsAndFlags[jvmZoneId] = "br"
            }
            when (jvmZoneId) {
                "Africa/Asmara" -> timeZoneIdsAndFlags[jvmZoneId] = "er"
                "Africa/Juba" -> timeZoneIdsAndFlags[jvmZoneId] = "ss"
                "America/Atikokan" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Bahia" -> timeZoneIdsAndFlags[jvmZoneId] = "br"
                "America/Bahia_Banderas" -> timeZoneIdsAndFlags[jvmZoneId] = "mx"
                "America/Blanc-Sablon" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Campo_Grande" -> timeZoneIdsAndFlags[jvmZoneId] = "br"
                "America/Creston" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Curacao" -> timeZoneIdsAndFlags[jvmZoneId] = "cw"
                "America/Fort_Nelson" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Kentucky/Louisville" -> timeZoneIdsAndFlags[jvmZoneId] = "us"
                "America/Knox_IN" -> timeZoneIdsAndFlags[jvmZoneId] = "xx"
                "America/Kralendijk" -> timeZoneIdsAndFlags[jvmZoneId] = "bq"
                "America/Lower_Princes" -> timeZoneIdsAndFlags[jvmZoneId] = "sx"
                "America/Marigot" -> timeZoneIdsAndFlags[jvmZoneId] = "mf"
                "America/Matamoros" -> timeZoneIdsAndFlags[jvmZoneId] = "mx"
                "America/Metlakatla" -> timeZoneIdsAndFlags[jvmZoneId] = "us"
                "America/Moncton" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Nuuk" -> timeZoneIdsAndFlags[jvmZoneId] = "gl"
                "America/Ojinaga" -> timeZoneIdsAndFlags[jvmZoneId] = "mx"
                "America/Punta_Arenas" -> timeZoneIdsAndFlags[jvmZoneId] = "cl"
                "America/Resolute" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "America/Santarem" -> timeZoneIdsAndFlags[jvmZoneId] = "br"
                "America/Sitka" -> timeZoneIdsAndFlags[jvmZoneId] = "us"
                "America/St_Barthelemy" -> timeZoneIdsAndFlags[jvmZoneId] = "bl"
                "America/Toronto" -> timeZoneIdsAndFlags[jvmZoneId] = "ca"
                "Antarctica/Macquarie" -> timeZoneIdsAndFlags[jvmZoneId] = "au"
                "Antarctica/South_Pole" -> timeZoneIdsAndFlags[jvmZoneId] = "aq"
                "Antarctica/Troll" -> timeZoneIdsAndFlags[jvmZoneId] = "aq"
                "Asia/Atyrau" -> timeZoneIdsAndFlags[jvmZoneId] = "kz"
                "Asia/Barnaul" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Chita" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Famagusta" -> timeZoneIdsAndFlags[jvmZoneId] = "cy"
                "Asia/Hebron" -> timeZoneIdsAndFlags[jvmZoneId] = "ps"
                "Asia/Ho_Chi_Minh" -> timeZoneIdsAndFlags[jvmZoneId] = "vn"
                "Asia/Kathmandu" -> timeZoneIdsAndFlags[jvmZoneId] = "np"
                "Asia/Khandyga" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Kolkata" -> timeZoneIdsAndFlags[jvmZoneId] = "in"
                "Asia/Macao" -> timeZoneIdsAndFlags[jvmZoneId] = "mo"
                "Asia/Novokuznetsk" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Qostanay" -> timeZoneIdsAndFlags[jvmZoneId] = "kz"
                "Asia/Srednekolymsk" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Tel_Aviv" -> timeZoneIdsAndFlags[jvmZoneId] = "il"
                "Asia/Tomsk" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Ust-Nera" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Asia/Yangon" -> timeZoneIdsAndFlags[jvmZoneId] = "mm"
                "Atlantic/Faroe" -> timeZoneIdsAndFlags[jvmZoneId] = "fo"
                "Europe/Astrakhan" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Europe/Belgrade" -> timeZoneIdsAndFlags[jvmZoneId] = "rs"
                "Europe/Busingen" -> timeZoneIdsAndFlags[jvmZoneId] = "de"
                "Europe/Guernsey" -> timeZoneIdsAndFlags[jvmZoneId] = "gg"
                "Europe/Isle_of_Man" -> timeZoneIdsAndFlags[jvmZoneId] = "im"
                "Europe/Jersey" -> timeZoneIdsAndFlags[jvmZoneId] = "je"
                "Europe/Kirov" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Europe/Mariehamn" -> timeZoneIdsAndFlags[jvmZoneId] = "ax"
                "Europe/Podgorica" -> timeZoneIdsAndFlags[jvmZoneId] = "me"
                "Europe/Saratov" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Europe/Ulyanovsk" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Europe/Volgograd" -> timeZoneIdsAndFlags[jvmZoneId] = "ru"
                "Pacific/Bougainville" -> timeZoneIdsAndFlags[jvmZoneId] = "pg"
                "Pacific/Chuuk" -> timeZoneIdsAndFlags[jvmZoneId] = "fm"
                "Pacific/Kanton" -> timeZoneIdsAndFlags[jvmZoneId] = "ki"
                "Pacific/Pohnpei" -> timeZoneIdsAndFlags[jvmZoneId] = "fm"
            }
        }
    }
    timeZoneIdsAndFlags["CST"] = null
    timeZoneIdsAndFlags["EST"] = null
    timeZoneIdsAndFlags["PST"] = null
    timeZoneIdsAndFlags["UTC"] = null
    timeZoneIdsAndFlags["GMT+00"] = null
    for (offset in 1..12) {
        val gmtOffset = String.format("%02d", offset)
        timeZoneIdsAndFlags["GMT+$gmtOffset"] = null
        timeZoneIdsAndFlags["GMT-$gmtOffset"] = null
    }
    return timeZoneIdsAndFlags
}